<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Glycostack PWA</title>
    <style>
        * { box-sizing: border-box; }
        body { 
            font-family: sans-serif; 
            background: #000000; color: #ffffff; margin: 0; padding: 15px;
            display: flex; flex-direction: column; height: 100vh;
        }
        .status-header {
            background: #1a1a1a; padding: 20px; border-radius: 15px;
            text-align: center; border: 1px solid #333; margin-bottom: 20px;
        }
        .label { color: #888; font-size: 0.8rem; text-transform: uppercase; }
        .value { color: #ff9800; font-size: 2.5rem; font-weight: bold; margin: 5px 0; }
        
        #stack-list { flex-grow: 1; overflow-y: auto; margin-bottom: 20px; }
        .stack-item {
            background: #1a1a1a; margin-bottom: 10px; padding: 15px;
            border-radius: 12px; border-left: 5px solid #ff9800;
            display: flex; justify-content: space-between; align-items: center;
        }
        .food-name { font-weight: bold; font-size: 1.1rem; text-transform: capitalize; }
        .food-carbs { color: #ff9800; font-weight: bold; font-size: 1.2rem; }

        .controls { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        button {
            border: none; border-radius: 15px; padding: 20px;
            font-size: 1.1rem; font-weight: bold; cursor: pointer;
            color: white; display: flex; flex-direction: column; align-items: center; gap: 10px;
        }
        .btn-voice { background: #2e7d32; }
        .btn-photo { background: #1565c0; }
        button:active { transform: scale(0.98); opacity: 0.8; }
    </style>
</head>
<body>

    <div class="status-header">
        <div class="label">AKT칈VNE SACHARIDY V KRVI</div>
        <div class="value" id="total-display">0.0g</div>
        <div class="label">DENN칗 LIMIT: 40g</div>
    </div>

    <div id="stack-list">
        </div>

    <div class="controls">
        <button class="btn-voice" onclick="startVoice()">
            <span style="font-size: 2rem;">游꿗</span> HLAS
        </button>
        <button class="btn-photo" onclick="takePhoto()">
            <span style="font-size: 2rem;">游닝</span> FOTO / SCAN
        </button>
    </div>

    <script>
        let totalCarbs = 0;

        // Funkcia, ktor치 prid치 polo쬶u do zoznamu a pripo캜칤ta gramy
        function addItem(name, amount) {
            const list = document.getElementById('stack-list');
            const item = document.createElement('div');
            item.className = 'stack-item';
            item.innerHTML = `
                <span class="food-name">${name}</span>
                <span class="food-carbs">+${amount}g</span>
            `;
            list.prepend(item); 

            totalCarbs += amount;
            document.getElementById('total-display').innerText = totalCarbs.toFixed(1) + 'g';
        }

        // Hlasov칠 ovl치danie
        function startVoice() {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            if (!SpeechRecognition) {
                alert("Mikrof칩n nie je podporovan칳 v tomto prehliada캜i.");
                return;
            }
            const recognition = new SpeechRecognition();
            recognition.lang = 'sk-SK';
            
            recognition.onstart = () => { 
                console.log("Po캜칰vam..."); 
                document.querySelector('.btn-voice').style.background = "red";
            };

            recognition.onresult = (event) => {
                const text = event.results[0][0].transcript;
                // Ak povie코 "ban치n", prirad칤me mu 23g (priemern칳 ban치n)
                let carbs = 20; 
                if(text.includes("ban치n")) carbs = 23;
                if(text.includes("jablko")) carbs = 15;
                if(text.includes("rohl칤k")) carbs = 30;

                addItem(text, carbs);
                document.querySelector('.btn-voice').style.background = "#2e7d32";
            };

            recognition.onerror = () => {
                document.querySelector('.btn-voice').style.background = "#2e7d32";
                alert("Chyba mikrof칩nu. Skontrolujte povolenia.");
            };

            recognition.start();
        }

        // Simul치cia foto/scanu (v 캞al코om kroku pripoj칤me re치lnu kameru)
        function takePhoto() {
            addItem("Foto anal칳za...", 12.5);
        }
    </script>
</body>
</html>